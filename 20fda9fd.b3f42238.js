(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{117:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r(0),i=r.n(n);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=i.a.createContext({}),s=function(e){var t=i.a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):c(c({},t),e)),r},u=function(e){var t=s(e.components);return i.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},m=i.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,a=e.parentName,l=p(e,["components","mdxType","originalType","parentName"]),u=s(r),m=n,d=u["".concat(a,".").concat(m)]||u[m]||b[m]||o;return r?i.a.createElement(d,c(c({ref:t},l),{},{components:r})):i.a.createElement(d,c({ref:t},l))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,a=new Array(o);a[0]=m;var c={};for(var p in t)hasOwnProperty.call(t,p)&&(c[p]=t[p]);c.originalType=e,c.mdxType="string"==typeof e?e:n,a[1]=c;for(var l=2;l<o;l++)a[l]=r[l];return i.a.createElement.apply(null,a)}return i.a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},71:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return a})),r.d(t,"metadata",(function(){return c})),r.d(t,"rightToc",(function(){return p})),r.d(t,"default",(function(){return s}));var n=r(2),i=r(6),o=(r(0),r(117)),a={title:"Implementing a Custom Reporter"},c={unversionedId:"custom-reporters",id:"custom-reporters",isDocsHomePage:!1,title:"Implementing a Custom Reporter",description:"While Liquibase Linter has some good core reporters, you may have a use case that's particular to your project and",source:"@site/docs/custom-reporters.md",slug:"/custom-reporters",permalink:"/liquibase-linter/docs/custom-reporters",version:"current",sidebar:"docs",previous:{title:"Using Reporters",permalink:"/liquibase-linter/docs/reporting/"},next:{title:"console",permalink:"/liquibase-linter/docs/reporting/console"}},p=[{value:"Writing the reporter",id:"writing-the-reporter",children:[{value:"Sample <code>Reporter</code> implementation",id:"sample-reporter-implementation",children:[]}]},{value:"Making the reporter discoverable",id:"making-the-reporter-discoverable",children:[]},{value:"Configuring the reporter in Maven",id:"configuring-the-reporter-in-maven",children:[]},{value:"Adding custom config to the <code>Reporter</code>",id:"adding-custom-config-to-the-reporter",children:[]}],l={rightToc:p};function s(e){var t=e.components,r=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},l,r,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"While Liquibase Linter has some good core reporters, you may have a use case that's particular to your project and\nwouldn't make sense as a core reporter."),Object(o.b)("p",null,"Fortunately it's trivial to implement custom reporters and apply them in your own project; you just need to write a\nJava class implementing the reporting interface and do a little configuration. "),Object(o.b)("h2",{id:"writing-the-reporter"},"Writing the reporter"),Object(o.b)("p",null,"There are a few interfaces to implement when writing a custom reporter in Java:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/whiteclarkegroup/liquibase-linter/blob/master/src/main/java/com/whiteclarkegroup/liquibaselinter/report/Reporter.java"}),"Reporter")," is the actual interface that your reporter must implement"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/whiteclarkegroup/liquibase-linter/blob/master/src/main/java/com/whiteclarkegroup/liquibaselinter/report/Reporter.java"}),"Reporter.Factory")," is the piece which ties the reporter into the ",Object(o.b)("inlineCode",{parentName:"li"},"lqlint.json")," configuration.")),Object(o.b)("p",null,"Fortunately, there are existing abstract classes that make this easy to do. Furthermore, the ",Object(o.b)("inlineCode",{parentName:"p"},"Reporter.Factory")," can\nexist as inner classes to the main ",Object(o.b)("inlineCode",{parentName:"p"},"Reporter")," implementation."),Object(o.b)("h3",{id:"sample-reporter-implementation"},"Sample ",Object(o.b)("inlineCode",{parentName:"h3"},"Reporter")," implementation"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-java"}),'package com.fake.fancyapp.liquibase;\n\nimport com.whiteclarkegroup.liquibaselinter.report.AbstractReporter;\nimport com.whiteclarkegroup.liquibaselinter.report.Report;\nimport com.whiteclarkegroup.liquibaselinter.report.ReporterConfig;\nimport com.whiteclarkegroup.liquibaselinter.report.ReportItem;\nimport java.util.List;\nimport java.io.PrintWriter;\n\npublic class CustomReporter extends AbstractReporter {\n    private static final String NAME = "custom-reporter";\n\n    public CustomReporter(ReporterConfig config) {\n        super(config, "ext"); // reports will have a `.ext` file extension\n    }\n\n    @Override\n    protected void printReport(PrintWriter output, Report report, List<ReportItem> items) {\n        // The \'items\' have already been filtered.\n        // All that is left to do is produce the output.\n        // Alternatively, extend an existing core reporter and override methods.\n    }\n\n    public static class Factory extends AbstractReporter.Factory<CustomReporter> {\n        public Factory() {\n            super(NAME);\n        }\n    }\n}\n')),Object(o.b)("p",null,"Some notes about how we've done this:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Extend the ",Object(o.b)("inlineCode",{parentName:"li"},"AbstractReporter")," class, which saves us from creating a lot of boilerplate ourselves."),Object(o.b)("li",{parentName:"ul"},"Create ",Object(o.b)("inlineCode",{parentName:"li"},"Factory"),". This links the ",Object(o.b)("inlineCode",{parentName:"li"},"CustomReporter")," to the Liquibase Linter configuration.  ")),Object(o.b)("p",null,"All the core reporters are implemented in this way as well, so if you're not sure how best to hook something up you\nmight try looking in the source at\n",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/whiteclarkegroup/liquibase-linter/tree/master/src/main/java/com/whiteclarkegroup/liquibaselinter/report"}),"some existing core reporters"),"\nthat do something similar"),Object(o.b)("h2",{id:"making-the-reporter-discoverable"},"Making the reporter discoverable"),Object(o.b)("p",null,"The class above should go into a new Maven project that depends on both ",Object(o.b)("inlineCode",{parentName:"p"},"liquibase-linter")," and ",Object(o.b)("inlineCode",{parentName:"p"},"liquibase"),"."),Object(o.b)("p",null,"The fact that the class exists isn't quite enough on its own; we need to tell Liquibase Linter that it's there. For this\nwe are using the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.oracle.com/javase/tutorial/sound/SPI-intro.html"}),"Service Provider Interface")," pattern -\nthis is natively supported in Java and for use cases like this is preferable to powerful-but-heavy classpath scanning\napproaches like that used by Spring."),Object(o.b)("p",null,"In our newly-created project, we'll create a new file at:"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"src/main/resources/META-INF/services/com.whiteclarkegroup.liquibaselinter.report.Reporter.Factory")),Object(o.b)("p",null,"And in the file, we'll write:"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"com.fake.fancyapp.liquibase.CustomReporter.Factory")),Object(o.b)("h2",{id:"configuring-the-reporter-in-maven"},"Configuring the reporter in Maven"),Object(o.b)("p",null,"In the project where our scripts live, we'll add a dependency on our reporters project to ",Object(o.b)("inlineCode",{parentName:"p"},"liquibase-maven-plugin"),", in\nmuch the same way that we ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/liquibase-linter/docs/configure"}),"added a dependency for ",Object(o.b)("inlineCode",{parentName:"a"},"liquibase-linter")," originally"),".\nSo for our example custom reporting project ",Object(o.b)("inlineCode",{parentName:"p"},"wcg-liquibase-linter")," we would have the following dependency."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-xml"}),"<plugin>\n    <groupId>org.liquibase</groupId>\n    <artifactId>liquibase-maven-plugin</artifactId>\n    <configuration>\n        ...\n    </configuration>\n    <dependencies>\n        <dependency>\n            <groupId>com.whiteclarkegroup</groupId>\n            <artifactId>liquibase-linter</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.fake.fancyapp</groupId>\n            <artifactId>liquibase-reporters</artifactId>\n            <version>0.1.0</version>\n        </dependency>\n    </dependencies>\n    <executions>\n        ...\n    </executions>\n</plugin>\n")),Object(o.b)("p",null,"Then all we need is to ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/liquibase-linter/docs/reporting/"}),"configure the reporter as normal")," in ",Object(o.b)("inlineCode",{parentName:"p"},"lqlint.json"),"."),Object(o.b)("h2",{id:"adding-custom-config-to-the-reporter"},"Adding custom config to the ",Object(o.b)("inlineCode",{parentName:"h2"},"Reporter")),Object(o.b)("p",null,"If additional configuration opens are required for the ",Object(o.b)("inlineCode",{parentName:"p"},"CustomReporter")," to operate, extend ",Object(o.b)("inlineCode",{parentName:"p"},"ReporterConfig")," and create\na new builder that extends ",Object(o.b)("inlineCode",{parentName:"p"},"ReporterConfig.BaseBuilder")," and change the ",Object(o.b)("inlineCode",{parentName:"p"},"Factory")," to extend ",Object(o.b)("inlineCode",{parentName:"p"},"ReporterConfig.BaseFactory"),",\nadding in the ",Object(o.b)("inlineCode",{parentName:"p"},"Config")," class to the generic type declaration. Add ",Object(o.b)("inlineCode",{parentName:"p"},"@JsonDeserialize")," to the ",Object(o.b)("inlineCode",{parentName:"p"},"Config")," class so that the\n",Object(o.b)("inlineCode",{parentName:"p"},"CustomReporter.Config")," can be loaded from the Liquibase Linter configuration."),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-java"}),"package com.fake.fancyapp.liquibase;\n\nimport com.fasterxml.jackson.databind.annotation.JsonDeserialize;\nimport com.whiteclarkegroup.liquibaselinter.report.AbstractReporter;\nimport com.whiteclarkegroup.liquibaselinter.report.Report;\nimport com.whiteclarkegroup.liquibaselinter.report.ReporterConfig;\nimport com.whiteclarkegroup.liquibaselinter.report.ReportItem;\nimport java.util.List;\nimport java.io.PrintWriter;\n\npublic class CustomReporter extends AbstractReporter {\n    private static final String NAME = \"custom-reporter\";\n\n    final String customConfigOption;\n\n    protected CustomReporter(CustomReporter.Config config) {\n        super(config);\n        this.customConfigOption = config.customConfigOption;\n    }\n\n    @Override\n    protected void printReport(PrintWriter output, Report report, List<ReportItem> items) {\n        // The 'items' have already been filtered.\n        // All that is left to do is produce the output.\n        // Alternatively, extend an existing core reporter and override methods.\n    }\n\n    public static class Factory extends AbstractReporter.BaseFactory<CustomReporter, Config> {\n        public Factory() {\n            super(NAME);\n        }\n    }\n\n    @JsonDeserialize(builder = Builder.class)\n    public static class Config extends ReporterConfig {\n        final String customConfigOption;\n        \n        public Config(Builder builder) {\n            super(builder);\n            customConfigOption = builder.customConfigOption;\n        }\n    }\n\n    public static class Builder extends ReporterConfig.BaseBuilder<Builder> {\n        String customConfigOption;\n\n        public Builder withCustomConfigOption(String customConfigOption) {\n            this.customConfigOption = customConfigOption;\n            return this;\n        }\n\n        @Override\n        public Config build() {\n            return new Config(this);\n        }\n    }\n}\n")))}s.isMDXComponent=!0}}]);